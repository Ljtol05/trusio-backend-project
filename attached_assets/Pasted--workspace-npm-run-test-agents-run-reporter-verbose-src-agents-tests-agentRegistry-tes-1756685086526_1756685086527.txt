~/workspace$ 
npm run test:agents -- --run --reporter=verbose src/agents/__tests__/agentRegistry.test.ts src/agents/__tests__/tools.test.ts

> envelope-app-backend@1.0.0 test:agents
> vitest run --config vitest.config.agents.ts --run --reporter=verbose src/agents/__tests__/agentRegistry.test.ts src/agents/__tests__/tools.test.ts


 RUN  v1.6.1 /home/runner/workspace

 ✓ |agents| src/agents/__tests__/tools.test.ts (14)
   ✓ Financial Tools (14)
     ✓ Tool Registry (2)
       ✓ should have all required transaction tools registered
       ✓ should return correct tool count
     ✓ Budget Tools (2)
       ✓ should execute budget analysis tool successfully
       ✓ should handle budget analysis errors gracefully
     ✓ Envelope Tools (2)
       ✓ should create envelope successfully
       ✓ should transfer funds between envelopes
     ✓ Transaction Tools (2)
       ✓ should categorize transactions correctly
       ✓ should analyze spending patterns
     ✓ Analysis Tools (1)
       ✓ should analyze budget variance
     ✓ Insight Tools (2)
       ✓ should generate personalized recommendations
       ✓ should identify financial opportunities
     ✓ Agent Handoff Tool (1)
       ✓ should execute agent handoff successfully
     ✓ Tool Error Handling (2)
       ✓ should handle non-existent tool gracefully
       ✓ should handle tool execution timeout
 ❯ |agents| src/agents/__tests__/agentRegistry.test.ts (0)

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 FAIL  |agents| src/agents/__tests__/agentRegistry.test.ts [ src/agents/__tests__/agentRegistry.test.ts ]
ReferenceError: Cannot access 'AGENT_PROMPTS' before initialization
 ❯ src/agents/config.ts:79:19
     77|     name: 'Financial Advisor',
     78|     description: 'Primary financial coachi…
     79|     instructions: AGENT_PROMPTS.financialA…
       |                   ^
     80|     model: env.OPENAI_MODEL_AGENTIC,
     81|     temperature: 0.7,
 ❯ src/agents/agentRegistry.ts:4:31

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed | 1 passed (2)
      Tests  14 passed (14)
   Start at  00:04:28
   Duration  799ms (transform 265ms, setup 88ms, collect 121ms, tests 119ms, environment 0ms, prepare 95ms)