~/workspace$ npm run test:agents -- --run --reporter=verbose src/agents/__tests__/agentRegistry.test.ts

> envelope-app-backend@1.0.0 test:agents
> vitest run --config vitest.config.agents.ts --run --reporter=verbose src/agents/__tests__/agentRegistry.test.ts


 RUN  v1.6.1 /home/runner/workspace

 ✓ |agents| src/agents/__tests__/agentRegistry.test.ts (12)
   ✓ AgentRegistry (12)
     ✓ Agent Initialization (2)
       ✓ should initialize all required agents
       ✓ should properly assign tools to agents
     ✓ Agent Routing (4)
       ✓ should route budget-related messages to budget coach
       ✓ should route transaction-related messages to transaction analyst
       ✓ should route insight-related messages to insight generator
       ✓ should default to financial advisor for general messages
     ✓ Agent Execution (3)
       ✓ should successfully run an agent with context
       ✓ should handle agent execution errors gracefully
       ✓ should throw error for non-existent agent
     ✓ Agent Capabilities (2)
       ✓ should return correct capabilities for each agent
       ✓ should return empty array for non-existent agent capabilities
     ✓ Agent Metrics (1)
       ✓ should return comprehensive metrics for all agents

 Test Files  1 passed (1)
      Tests  12 passed (12)
   Start at  00:25:51
   Duration  787ms (transform 317ms, setup 93ms, collect 332ms, tests 11ms, environment 0ms, prepare 153ms)

~/workspace$ npm run test:agents -- --run --reporter=verbose src/agents/__tests__/tools.test.ts

> envelope-app-backend@1.0.0 test:agents
> vitest run --config vitest.config.agents.ts --run --reporter=verbose src/agents/__tests__/tools.test.ts


 RUN  v1.6.1 /home/runner/workspace

 ✓ |agents| src/agents/__tests__/tools.test.ts (14)
   ✓ Financial Tools (14)
     ✓ Tool Registry (2)
       ✓ should have all required transaction tools registered
       ✓ should return correct tool count
     ✓ Budget Tools (2)
       ✓ should execute budget analysis tool successfully
       ✓ should handle budget analysis errors gracefully
     ✓ Envelope Tools (2)
       ✓ should create envelope successfully
       ✓ should transfer funds between envelopes
     ✓ Transaction Tools (2)
       ✓ should categorize transactions correctly
       ✓ should analyze spending patterns
     ✓ Analysis Tools (1)
       ✓ should analyze budget variance
     ✓ Insight Tools (2)
       ✓ should generate personalized recommendations
       ✓ should identify financial opportunities
     ✓ Agent Handoff Tool (1)
       ✓ should execute agent handoff successfully
     ✓ Tool Error Handling (2)
       ✓ should handle non-existent tool gracefully
       ✓ should handle tool execution timeout

 Test Files  1 passed (1)
      Tests  14 passed (14)
   Start at  00:25:58
   Duration  635ms (transform 191ms, setup 133ms, collect 91ms, tests 117ms, environment 0ms, prepare 113ms)

~/workspace$ npm run test:agents -- --run --reporter=verbose src/agents/__tests__/performance.test.ts

> envelope-app-backend@1.0.0 test:agents
> vitest run --config vitest.config.agents.ts --run --reporter=verbose src/agents/__tests__/performance.test.ts


 RUN  v1.6.1 /home/runner/workspace

 ✓ |agents| src/agents/__tests__/performance.test.ts (12)
   ✓ Agent Performance Tests (12)
     ✓ Agent Response Times (3)
       ✓ should respond within acceptable time limits
       ✓ should handle multiple concurrent agent requests
       ✓ should maintain performance with large financial context
     ✓ Tool Performance (2)
       ✓ should execute tools within acceptable time limits
       ✓ should handle concurrent tool executions
     ✓ Memory and Resource Usage (2)
       ✓ should not leak memory during repeated operations
       ✓ should handle agent registry operations efficiently
     ✓ Stress Testing (2)
       ✓ should handle high-frequency agent requests
       ✓ should gracefully degrade under extreme load
     ✓ Edge Cases and Resilience (3)
       ✓ should handle malformed context gracefully
       ✓ should handle very long messages efficiently
       ✓ should maintain performance with frequent agent switching

 Test Files  1 passed (1)
      Tests  12 passed (12)
   Start at  00:26:07
   Duration  770ms (transform 305ms, setup 110ms, collect 347ms, tests 31ms, environment 0ms, prepare 82ms)